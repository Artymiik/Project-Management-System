@using pms_cs.ViewModel
@model IndexModel

@{
    var taskViewModel = new TaskCreateViewModel();
}

<head>
    <link rel="stylesheet" href="~/css/Index/IndexAuth.css">
</head>

<header>
    <div class="container__header">
        <div class="left">
            <p>Project Management System</p>
        </div>
        <div class="right">
            <div class="add">
                <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-plus"><path d="M5 12h14"/><path d="M12 5v14"/></svg>
            </div>
            <img src="~/images/logo.jpg" alt="" class="logo">
        </div>
    </div>
</header>

<div id="popUp">
    <div class="style__popup">
        <div class="elem">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-building-2"><path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"/><path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"/><path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"/><path d="M10 6h4"/><path d="M10 10h4"/><path d="M10 14h4"/><path d="M10 18h4"/></svg>
            <a asp-controller="Company" asp-action="CreateCompany">Create company</a>
        </div>
        <div class="line"></div>
        <div class="elem">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-clipboard-check"><rect width="8" height="4" x="8" y="2" rx="1" ry="1"/><path d="M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2"/><path d="m9 14 2 2 4-4"/></svg>
            <a href="">Create task</a>
        </div>
        <div class="elem">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-calendar-check-2"><path d="M8 2v4"/><path d="M16 2v4"/><path d="M21 14V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h8"/><path d="M3 10h18"/><path d="m16 20 2 2 4-4"/></svg>
            <a href="">Created tasks</a>
        </div>
        <div class="elem">
            <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-message-square-warning"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"/><path d="M12 7v2"/><path d="M12 13h.01"/></svg>
            <a href="">Create report</a>
        </div>
    </div>
</div>

<div class="elements">
    <div class="page">
        <div class="Management">
            <div class="top">
                <p>Management Company</p>
                <a href="">New</a>
            </div>
            <div class="find">
                <input type="text" placeholder="Find people">
            </div>
            
            <div class="peoples">
                @if (Model.AppUser?.Count() == 0)
                {
                    <p style="color: #838383; text-align: center; font-size: 13px; font-weight: 300;">
                        You don't have any colleagues or an active company
                    </p>
                }
                
                @foreach (var user in Model.AppUser)
                {
                    <div class="people">
                        <img src="~/images/logo.jpg" alt="">
                        <p>@user.UserName</p>
                    </div>
                }
            </div>
            
            <div class="link">
                <p class="Title__link">
                    Invitation link 
                    <span class="copying" style="color: #0a53be; font-size: 12px; margin-left: 5px; cursor: pointer; display: none;">
                        Copy!
                    </span>
                </p>
                <div class="link__block">
                    <a class="btnCopy">
                        <input class="referralLinkText" type="hidden" value="@Model.AppCompany?.ReferralLink">
                        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-copy"><rect width="14" height="14" x="8" y="8" rx="2" ry="2"/><path d="M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2"/></svg>
                        Referral link for inviting colleagues
                    </a>
                </div>
            </div>
        </div>
        <div class="Functions">
            <p class="Title__function">Home</p>
            <div class="Description__function__block">
                <div class="border__svg">
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="lucide lucide-square-pen"><path d="M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"/><path d="M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z"/></svg>
                </div>
                <p>Quick actions</p>
            </div>
            
            <div class="Navigation__block__function">
                <div class="left">
                    <div class="card__create__task">
                        <p class="Title__card">Create a task for the company</p>
                        <p class="Description__task">Choose the person who will receive your task</p>
                        <form asp-controller="Task" asp-action="Create" method="post">
                            <label asp-for="@taskViewModel.Title">Task name *</label>
                            <input asp-for="@taskViewModel.Title" type="text" placeholder="title your new task...">
                            <div class="flex">
                                <select asp-for="@taskViewModel.UserIdRecipient">
                                    <option>Select people</option>
                                    @foreach (var user in Model.UsersTask)
                                    {
                                        <option value="@user.Id">@user.UserName</option>
                                    }
                                </select>
                                <input asp-for="@taskViewModel.Ending" type="text" placeholder="ending task...">
                            </div>
                            <textarea asp-for="@taskViewModel.Description" placeholder="description for task"></textarea>
                            <button>Send task</button>
                        </form>
                    </div>
                </div>
                <div class="right">
                    <div class="card__create__report">
                        <p class="Title__card">Create a task for the company</p>
                        <p class="Description__task">Choose the person who will receive your task</p>
                        <form>
                            <label>Task name *</label>
                            <input type="text" placeholder="title your new task...">
                            <div class="flex">
                                <select>
                                    <option>Select people</option>
                                    <option>--Me--</option>
                                    @foreach (var user in Model.UsersTask)
                                    {
                                        <option value="@user.Id">@user.UserName</option>
                                    }
                                </select>
                                <input type="text" placeholder="ending task...">
                            </div>
                            <textarea placeholder="description for task"></textarea>
                            <button>Send task</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <div class="Tasks">
            <div class="Tasks__card">
                <div class="Title__card">My Tasks</div>
                @if (@Model.AllTasks != null)
                {
                    @foreach(var item in Model.AllTasks)
                    {
                        DateTime today = DateTime.Now;
                        TimeSpan remaining = item.Ending - today;
                        int days = remaining.Days;
                    
                        <div class="task__number">
                            @if (days < 0)
                            {
                                <p class="time">Overdue</p>
                            }
                            else if (days == 0)
                            {
                                <p class="time">Today is the last day</p>
                            }
                            else
                            {
                                <p class="time">@days days left</p>
                            }
                            <a asp-controller="Task" asp-action="Details" asp-route-id="@item.Id">@item.Title</a>
                        </div>
                    }
                }
                else
                {
                    <p class="all__task__not__found">We have not found your tasks</p>
                }
            </div>
        </div>
    </div>
</div>